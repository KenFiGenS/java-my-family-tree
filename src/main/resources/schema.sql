DROP TABLE IF EXISTS USERS, FAMILY_MEMBERS, MOTHER, FATHER, SONS, DAUGHTERS;

CREATE TABLE IF NOT EXISTS USERS (
  USER_ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
  EMAIL VARCHAR (254) UNIQUE,
  NAME VARCHAR (250),
  LASTNAME VARCHAR (250),
  SURNAME VARCHAR (250),
  BIRTHDAY DATE,
  PLACE_OF_BIRTH VARCHAR (1000)
);

CREATE TABLE IF NOT EXISTS FAMILY_MEMBERS (
  FAMILY_MEMBER_ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
  NAME VARCHAR (250),
  LASTNAME VARCHAR (250),
  SURNAME VARCHAR (250),
  BIRTHDAY DATE,
  PLACE_OF_BIRTH VARCHAR (1000)
);

CREATE TABLE IF NOT EXISTS MOTHER (
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
  MOTHER_ID INT NOT NULL REFERENCES FAMILY_MEMBERS (FAMILY_MEMBER_ID) ON DELETE CASCADE,
  PRIMARY KEY (USER_ID, MOTHER_ID)
);

CREATE TABLE IF NOT EXISTS FATHER (
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
  FATHER_ID INT NOT NULL REFERENCES FAMILY_MEMBERS (FAMILY_MEMBER_ID) ON DELETE CASCADE,
  PRIMARY KEY (USER_ID, FATHER_ID)
);

CREATE TABLE IF NOT EXISTS SONS (
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
  SON_ID INT NOT NULL REFERENCES FAMILY_MEMBERS (FAMILY_MEMBER_ID) ON DELETE CASCADE,
  PRIMARY KEY (USER_ID, SON_ID)
);

CREATE TABLE IF NOT EXISTS DAUGHTERS (
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
  DAUGHTER_ID INT NOT NULL REFERENCES FAMILY_MEMBERS (FAMILY_MEMBER_ID) ON DELETE CASCADE,
  PRIMARY KEY (USER_ID, DAUGHTER_ID)
);